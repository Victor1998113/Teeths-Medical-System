{"remainingRequest":"D:\\toolOfjava\\factoryFront\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\toolOfjava\\factoryFront\\front\\src\\views\\sys\\PatientsList.vue?vue&type=style&index=0&id=c2f455f0&scoped=true&lang=css&","dependencies":[{"path":"D:\\toolOfjava\\factoryFront\\front\\src\\views\\sys\\PatientsList.vue","mtime":1627884533817},{"path":"D:\\toolOfjava\\factoryFront\\front\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\toolOfjava\\factoryFront\\front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\toolOfjava\\factoryFront\\front\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\toolOfjava\\factoryFront\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\toolOfjava\\factoryFront\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLyrooajmoLzmoLflvI8qLw0KLmRlbW8tdGFibGUtZXhwYW5kIHsNCiAgZm9udC1zaXplOiAwOw0KfQ0KLmRlbW8tdGFibGUtZXhwYW5kIGxhYmVsIHsNCiAgd2lkdGg6IDkwcHg7DQogIGNvbG9yOiAjOTlhOWJmOw0KfQ0KLmRlbW8tdGFibGUtZXhwYW5kIC5lbC1mb3JtLWl0ZW0gew0KICBtYXJnaW4tcmlnaHQ6IDA7DQogIG1hcmdpbi1ib3R0b206IDA7DQogIHdpZHRoOiA1MCU7DQp9DQoNCg0K"},{"version":3,"sources":["PatientsList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6xBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PatientsList.vue","sourceRoot":"src/views/sys","sourcesContent":["<template>\r\n  <div>\r\n\r\n\r\n    <!--   添加患者弹出层-->\r\n    <el-dialog  :before-close=\"handleClose\" title=\"提示\" :visible.sync=\"dialogTableVisible\" >\r\n\r\n      <el-form :model=\"form\" :rules=\"editFormRules\"  ref=\"editForm\" >\r\n        <el-form-item label=\"患者名字\" prop=\"name\" :label-width=\"formLabelWidth\">\r\n          <el-input v-model=\"form.name\" autocomplete=\"off\" ></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"患者年龄\" prop=\"age\" :label-width=\"formLabelWidth\">\r\n          <el-input v-model=\"form.age\" autocomplete=\"off\" ></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"患者性别\" prop=\"gender\" :label-width=\"formLabelWidth\">\r\n          <el-radio-group v-model=\"form.gender\">\r\n            <el-radio  :label=\"nan\">男</el-radio>\r\n            <el-radio  :label=\"nv\">女</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"联系电话\" prop=\"phone\" :label-width=\"formLabelWidth\">\r\n          <el-input v-model=\"form.phone\" autocomplete=\"off\" ></el-input>\r\n        </el-form-item>\r\n\r\n        <el-form-item v-if=\"timeState\" label=\"就诊时间\" prop=\"clinictime\" :label-width=\"formLabelWidth\">\r\n          <div class=\"block\">\r\n            <el-date-picker\r\n                v-model=\"form.clinictime\"\r\n                @blur=\"clinictimeDoctor\"\r\n                type=\"datetime\"\r\n                format=\"yyyy-MM-dd\"\r\n                value-format=\"yyyy-MM-dd\"\r\n                placeholder=\"选择日期时间\">\r\n            </el-date-picker>\r\n          </div>\r\n        </el-form-item>\r\n\r\n\r\n        <el-form-item v-if=\"timeState\" label=\"就诊医生\" :label-width=\"formLabelWidth\">\r\n          <el-select v-model=\"form.doctorid\" @change=\"schedulingTime\" placeholder=\"请选择要医生\">\r\n            <el-option v-for=\"dc in doctorList\"\r\n                       :key=\"dc.doctorid\"\r\n                       :label=\"dc.name\"\r\n                       :value=\"dc.doctorid\"\r\n            >\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n\r\n        <el-form-item v-if=\"timeState\" prop=\"atid\" label=\"排班时间\" :label-width=\"formLabelWidth\">\r\n          <el-select v-model=\"form.atid\" @change=\"schedulingTime\" placeholder=\"排班时间\">\r\n            <el-option v-for=\"st in stimeList\"\r\n                       :key=\"st.atid\"\r\n                       :label=\"st.datetime\"\r\n                       :value=\"st.atid\"\r\n            >\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n\r\n\r\n\r\n        <el-form-item label=\"基本病情\" prop=\"petient\" :label-width=\"formLabelWidth\">\r\n\r\n          <el-input\r\n              type=\"textarea\"\r\n              :rows=\"2\"\r\n              placeholder=\"请输入患者的基本情况\"\r\n              v-model=\"form.petient\">\r\n          </el-input>\r\n        </el-form-item>\r\n\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\" >\r\n        <el-button type=\"primary\" @click=\"submitForm('editForm')\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <!--    手术-->\r\n    <el-dialog title=\"手术\" :visible.sync=\"surgery\" width=\"60%\">\r\n      <el-row>\r\n        <el-col :span=\"8\">\r\n          <div class=\"grid-content bg-purple\">\r\n            <div class=\"grid-content bg-purple\">\r\n              <el-input\r\n                  placeholder=\"请输入手术名称\"\r\n                  v-model=\"surgeryInput\"\r\n                  clearable>\r\n              </el-input>\r\n            </div>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <div class=\"grid-content bg-purple-light\">\r\n<!--            this.newSurgery.surgeryPatientsid = patientsid-->\r\n<!--            this.newSurgery.surgeryDoctorid = doctorid-->\r\n            <el-button @click=\"selectSurgery\" icon=\"el-icon-search\">搜索</el-button>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n      <el-table :data=\"surgeryData\" ref=\"multipleTableSurgery\" @selection-change=\"handleSelectionChange\" height=\"300\">\r\n        <el-table-column type=\"selection\" width=\"55\"></el-table-column>\r\n        <el-table-column property=\"opsid\" label=\"手术编号\" ></el-table-column>\r\n        <el-table-column property=\"opsname\" label=\"手术名称\" ></el-table-column>\r\n        <el-table-column property=\"opsmoney\" label=\"手术价格\"></el-table-column>\r\n        <el-table-column property=\"opsname\" label=\"手术名称\" ></el-table-column>\r\n      </el-table>\r\n\r\n      <div style=\"font-size: 18px\" >总金额：<span style=\" font-size: 20px;color: #ff3434\">{{surgerySumMoney}}</span> 元</div>\r\n      <div slot=\"footer\" class=\"dialog-footer\" >\r\n        <el-button @click=\"surgery = false\">取 消</el-button>\r\n        <el-button type=\"primary\"  @click=\"affirmSurgery\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <!--    开药外层-->\r\n    <el-dialog title=\"开药\" :visible.sync=\"dialogTable\" width=\"60%\">\r\n      <el-row>\r\n        <el-col :span=\"8\">\r\n          <div class=\"grid-content bg-purple\">\r\n            <div class=\"grid-content bg-purple\">\r\n              <el-input\r\n                  placeholder=\"请输入药品名称\"\r\n                  v-model=\"prescribeInput\"\r\n                  clearable>\r\n              </el-input>\r\n            </div>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <div class=\"grid-content bg-purple-light\">\r\n            <el-button @click=\"selectPrescribe\" icon=\"el-icon-search\">搜索</el-button>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n      <el-table @selection-change=\"drugHandleSelectionChange\" :data=\"gridData\" height=\"300\">\r\n        <el-table-column type=\"selection\" width=\"55\"></el-table-column>\r\n        <el-table-column property=\"drugid\" label=\"药品编号\" ></el-table-column>\r\n        <el-table-column property=\"name\" label=\"药品名称\" ></el-table-column>\r\n        <el-table-column property=\"type\" label=\"药品类别\" ></el-table-column>\r\n        <el-table-column property=\"price\" label=\"药品价格\"></el-table-column>\r\n        <el-table-column property=\"count\" label=\"药品数量\"></el-table-column>\r\n      </el-table>\r\n\r\n\r\n      <div style=\"font-size: 18px\" >总金额：<span style=\" font-size: 20px;color: #ff3434\">{{drugSumMoney}}</span> 元</div>\r\n      <div slot=\"footer\" class=\"dialog-footer\" >\r\n        <el-button @click=\"dialogTable = false\">取 消</el-button>\r\n        <el-button type=\"primary\"  @click=\"determineThePrescription\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <!--    结算-->\r\n    <el-dialog title=\"结算\" :visible.sync=\"settleAccounts\" width=\"60%\">\r\n\r\n      <el-table :data=\"settleAccountsData\" height=\"300\">\r\n        <el-table-column property=\"id\" label=\"编号\" ></el-table-column>\r\n        <el-table-column property=\"clinictime\" width=\"200px\" label=\"创建时间\" ></el-table-column>\r\n        <el-table-column property=\"count\" label=\"数量\"></el-table-column>\r\n        <el-table-column property=\"doctorName\" label=\"医生名称\"></el-table-column>\r\n        <el-table-column property=\"opsname\" label=\"手术名称\"></el-table-column>\r\n        <el-table-column property=\"drugName\" width=\"200px\" label=\"药品名称\"></el-table-column>\r\n        <el-table-column property=\"pname\" label=\"患者名称\"></el-table-column>\r\n        <el-table-column property=\"cost\" label=\"单价\"></el-table-column>\r\n      </el-table>\r\n\r\n      <div style=\"font-size: 18px\" >总金额：<span style=\" font-size: 20px;color: #ff3434\">{{medical.payamount}}</span> 元</div>\r\n\r\n\r\n      <div slot=\"footer\" class=\"dialog-footer\" >\r\n        <el-button @click=\"settleAccounts = false\">取 消</el-button>\r\n        <el-button type=\"primary\"  @click=\"determineTheSettlement\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <el-row>\r\n      <el-col :span=\"24\">\r\n        <div class=\"grid-content bg-purple-dark\">\r\n\r\n          <div id=\"magicalDragScene\" class=\"mc-root mc-ui-absolute-pane\">\r\n            <el-row>\r\n              <el-col :xs=\"24\">\r\n                <el-card header=\"患者列表\">\r\n\r\n                  <el-row>\r\n                    <el-col :span=\"4\">\r\n                      <div class=\"grid-content bg-purple\">\r\n                        <div class=\"grid-content bg-purple\">\r\n                          <el-input\r\n                              placeholder=\"请输入患者名字\"\r\n                              v-model=\"input\"\r\n                              clearable>\r\n                          </el-input>\r\n                        </div>\r\n                      </div>\r\n                    </el-col>\r\n                    <el-col :span=\"4\">\r\n                      <div class=\"grid-content bg-purple-light\">\r\n                        <el-button @click=\"getPatientsList\" icon=\"el-icon-search\" type=\"primary\" plain>搜索</el-button>\r\n                      </div>\r\n                    </el-col>\r\n                    <el-col :span=\"16\">\r\n                      <div class=\"grid-content bg-purple\" style=\"text-align: left\">\r\n                        <el-button class=\"el-icon-circle-plus-outline\" type=\"primary\" @click=\"add\"> 添加患者</el-button>\r\n                      </div>\r\n                    </el-col>\r\n                  </el-row>\r\n\r\n\r\n\r\n                </el-card>\r\n              </el-col>\r\n              <el-col :xs=\"24\">\r\n                <el-table\r\n                    :data=\"tableData\"\r\n                    style=\"width: 100%\"\r\n                    :default-sort = \"{prop: 'date', order: 'descending'}\">\r\n\r\n                  <el-table-column type=\"expand\">\r\n                    <template slot-scope=\"props\">\r\n                      <el-form label-position=\"left\" inline class=\"demo-table-expand\">\r\n                        <el-form-item label=\"患者姓名:\">\r\n                          <span>{{ props.row.name }}</span>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"患者电话:\">\r\n                          <span>{{ props.row.phone }}</span>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"性别:\">\r\n                          <span>{{ props.row.gender }}</span>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"年龄:\">\r\n                          <span>{{ props.row.age }}</span>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"就诊时间:\">\r\n                          <span>{{ props.row.clinictime }}</span>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"就诊医生:\">\r\n                          <span>{{ props.row.doctorName }}</span>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"病情:\">\r\n                          <span>{{ props.row.petient }}</span>\r\n                        </el-form-item>\r\n                      </el-form>\r\n                    </template>\r\n                  </el-table-column>\r\n\r\n                  <el-table-column\r\n                      prop=\"patientsid\"\r\n                      label=\"编号\"\r\n                      sortable>\r\n                  </el-table-column>\r\n                  <el-table-column\r\n                      prop=\"name\"\r\n                      label=\"患者姓名\"\r\n                      sortable>\r\n                  </el-table-column>\r\n                  <el-table-column\r\n                      prop=\"age\"\r\n                      label=\"年龄\"\r\n                      sortable>\r\n                  </el-table-column>\r\n                  <el-table-column\r\n                      prop=\"doctorName\"\r\n                      label=\"就诊医生\"\r\n                      sortable>\r\n                  </el-table-column>\r\n\r\n                  <el-table-column\r\n                      prop=\"pstate\"\r\n                      label=\"状态\"\r\n                      sortable>\r\n                    <template slot-scope=\"scope\">\r\n                      <el-tag size=\"small\" v-if=\"scope.row.pstate === 0\">正在治疗</el-tag>\r\n                      <el-tag size=\"small\" v-if=\"scope.row.pstate === 1\" type=\"success\">治疗完成</el-tag>\r\n                    </template>\r\n                  </el-table-column>\r\n\r\n                  <el-table-column\r\n                      width=\"200\"\r\n                      prop=\"clinictime\"\r\n                      label=\"就诊日期\"\r\n                      sortable>\r\n                  </el-table-column>\r\n\r\n\r\n                  <el-table-column label=\"操作\" width=\"380\">\r\n                    <template slot-scope=\"scope\">\r\n                      <div v-if=\"scope.row.pstate==0\">\r\n                      <el-button size=\"mini\" type=\"info\" plain\r\n                                 @click=\"editHandle(scope.row.patientsid)\">编辑</el-button>\r\n\r\n                      <el-button size=\"mini\" type=\"success\" plain\r\n                                 @click=\"statesurgery(scope.row.patientsid,scope.row.doctorid)\">手术</el-button>\r\n\r\n\r\n\r\n                      <el-button size=\"mini\" type=\"primary\" plain\r\n                                 @click=\"prescribe(scope.row.patientsid,scope.row.doctorid)\">开药</el-button>\r\n\r\n                      <el-button size=\"mini\" type=\"warning\" plain\r\n                                 @click=\"closeAnAccount(scope.row.patientsid)\">结算</el-button>\r\n\r\n                      <el-button\r\n                          size=\"mini\"\r\n                          type=\"danger\"\r\n                          @click=\"mydelete(scope.row.patientsid,scope.row.atid)\">删除</el-button>\r\n                      </div>\r\n                    </template>\r\n                  </el-table-column>\r\n                </el-table>\r\n\r\n                <div class=\"block\" style=\"background-color: white\">\r\n                  <el-pagination class=\"el-pagination\"\r\n                                 @size-change=\"handleSizeChange\"\r\n                                 @current-change=\"handleCurrentChange\"\r\n                                 layout=\"total, sizes, prev, pager, next, jumper\"\r\n                                 :page-sizes=\"[5, 10, 30, 50]\"\r\n                                 :current-page=\"current\"\r\n                                 :page-size=\"size\"\r\n                                 :total=\"total\">\r\n                  </el-pagination>\r\n                </div>\r\n              </el-col>\r\n\r\n            </el-row>\r\n          </div>\r\n        </div>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n\r\n\r\n\r\n</template>\r\n\r\n<script>\r\nimport Input_num from '@/components/Input_num'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      input: '',\r\n      nan:'男',\r\n      nv:'女',\r\n      total: 0,\r\n      num: 1,\r\n      size: 5,\r\n      current: 1,\r\n      surgerySumMoney:0,\r\n      timeState:false,\r\n\r\n      //计数器\r\n      min_val: 1, // 设定最小值\r\n      max_val: Infinity, // 设定最大值,Infinity表示无穷大\r\n      val: 1 ,// 计数器初始值\r\n\r\n      editFormRules: {\r\n        name: [\r\n          {required: true, message: '请输入用户名称', trigger: 'blur'}\r\n        ],\r\n        gender: [\r\n          {required: true, message: '请选择性别', trigger: 'blur'}\r\n        ],\r\n\r\n        age: [\r\n          {required: true, message: '请输入年龄', trigger: 'blur'}\r\n        ],\r\n        phone: [\r\n          {required: true, message: '请输入用户电话', trigger: 'blur'},\r\n          {min: 11, message: '长度为11位', trigger: 'blur'}\r\n        ],\r\n\r\n        clinictime: [\r\n          {required: true, message: '请选择时间', trigger: 'blur'}\r\n        ],\r\n        petient: [\r\n          {required: true, message: '请输入病情', trigger: 'blur'}\r\n        ],\r\n        doctorid:[\r\n          {required: true, message: '请选择医生', trigger: 'blur'}\r\n        ],\r\n        atid:[\r\n          {required: true, message: '请选择排版时间', trigger: 'blur'}\r\n        ]\r\n\r\n      },\r\n\r\n      //添加时间\r\n      pickerOptions: {\r\n        shortcuts: [{\r\n          text: '今天',\r\n          onClick(picker) {\r\n            picker.$emit('pick', new Date());\r\n          }\r\n        }, {\r\n          text: '昨天',\r\n          onClick(picker) {\r\n            const date = new Date();\r\n            date.setTime(date.getTime() - 3600 * 1000 * 24);\r\n            picker.$emit('pick', date);\r\n          }\r\n        }, {\r\n          text: '一周前',\r\n          onClick(picker) {\r\n            const date = new Date();\r\n            date.setTime(date.getTime() - 3600 * 1000 * 24 * 7);\r\n            picker.$emit('pick', date);\r\n          }\r\n        }]\r\n      },\r\n      value1: '',\r\n\r\n      //表格数据呈现\r\n      tableData: [],\r\n      doctorList:[],\r\n      stimeList:[],\r\n\r\n\r\n      //手术弹出层数据\r\n      surgeryData: [],\r\n\r\n\r\n      //开药弹出层数据\r\n      gridData: [],\r\n\r\n      //内层数据明细\r\n      orderDetails: [],\r\n      //手术surgery\r\n      surgery:false,\r\n      //开药弹出层数据\r\n      dialogTable: false,\r\n\r\n      //结算\r\n      settleAccounts: false,\r\n      //结算二维码\r\n      QRCode: false,\r\n\r\n      //编辑患者弹出层\r\n      dialogTableVisible: false,\r\n      //添加弹出层\r\n      dialogFormVisible: false,\r\n      form: {\r\n        name: '',\r\n        age: '',\r\n        gender: '',\r\n        clinictime: '',\r\n        atid:'',\r\n        phone: '',\r\n        doctorid: '',\r\n        doctorName:'',\r\n        petient: ''\r\n      },\r\n      formLabelWidth: '120px',\r\n      saveUpdate:false,\r\n      surgeryInput:'',\r\n      multipleSelection: [],\r\n      newSurgery:{\r\n        ids:[],\r\n        surgeryPatientsid:'',\r\n        surgeryDoctorid:''\r\n      },\r\n      prescribeInput:'',\r\n      drugSumMoney:0,\r\n\r\n      drugMultipleSelection: [],\r\n      drugNewSurgery:{\r\n        ids:[],\r\n        surgeryPatientsid:'',\r\n        surgeryDoctorid:''\r\n      },\r\n      settleAccountsData:[],\r\n      medical:{\r\n        patientsid:'',\r\n        count:0,\r\n        paytime:'',\r\n        payment:'支付宝',\r\n        payamount:0,\r\n        orderstate:'',\r\n      },\r\n      patientNumber:''\r\n    }\r\n  },\r\n\r\n  //计数器\r\n  components: {\r\n    Input_num\r\n  },\r\n\r\n  created() {\r\n    this.getPatientsList()\r\n    this.getTheTypeOfMedicineAndSurgery()\r\n  },\r\n  methods: {\r\n\r\n\r\n    //确定结算\r\n    determineTheSettlement(){\r\n      if(this.medical.payamount !=0){\r\n        this.$http.post(\"/sys/medical/pay\",this.medical).then(res => {\r\n          console.log(\"状态值\")\r\n          console.log(res)\r\n          if(res.data.data===\"\"){\r\n            this.$message({\r\n              showClose: true,\r\n              message: '会员扣费成功！',\r\n              type: 'success'\r\n            });\r\n            this.getPatientsList()\r\n          }else{\r\n            var myWindow = window.open('/index','width=200,height=100');\r\n            myWindow.document.write(res.data.data);\r\n          }\r\n        })\r\n        this.getPatientsList()\r\n        this.settleAccounts = false\r\n      }else {\r\n        this.$message({\r\n          showClose: true,\r\n          message: '费用不能等于0！',\r\n          type: 'error'\r\n        });\r\n      }\r\n\r\n    },\r\n\r\n    //结算\r\n    closeAnAccount(id){\r\n      this.medical.payamount = 0\r\n      this.medical.patientsid = id\r\n      this.settleAccounts = true\r\n      this.$http.get(\"/sys/medical/listById?id=\"+id).then(res => {\r\n        this.settleAccountsData = res.data.data;\r\n        this.settleAccountsData.forEach(row => {\r\n          this.medical.payamount+=row.cost\r\n        });\r\n        this.medical.count = res.data.data.length\r\n      });\r\n    },\r\n\r\n    //手术的选择框\r\n    handleSelectionChange(val) {\r\n      this.surgerySumMoney = 0\r\n      this.multipleSelection = []\r\n      this.multipleSelection = val;\r\n      for (var i=0;i<this.multipleSelection.length;i++){\r\n        this.surgerySumMoney += this.multipleSelection[i].opsmoney\r\n      }\r\n    },\r\n\r\n    //药品的选择框\r\n    drugHandleSelectionChange(val){\r\n      this.drugSumMoney = 0\r\n      this.drugMultipleSelection = []\r\n      this.drugMultipleSelection = val\r\n      for(var i=0;i<this.drugMultipleSelection.length;i++){\r\n          this.drugSumMoney += this.drugMultipleSelection[i].price\r\n      }\r\n    },\r\n\r\n\r\n    formatter(row, column) {\r\n      return row.address;\r\n    },\r\n\r\n\r\n    //手术搜索\r\n    selectSurgery(){\r\n      this.getTheTypeOfMedicineAndSurgery()\r\n    },\r\n\r\n    //药品搜索\r\n    selectPrescribe(){\r\n      this.getTheTypeOfMedicineAndSurgery()\r\n    },\r\n\r\n    //确定开药\r\n    determineThePrescription(){\r\n\r\n      if(this.drugSumMoney==0){\r\n        this.$message({\r\n          showClose: true,\r\n          message: '请选择药品',\r\n          type: 'error'\r\n        });\r\n      }else{\r\n\r\n        this.drugNewSurgery.ids = []\r\n\r\n        this.drugMultipleSelection.forEach(row =>{\r\n          this.drugNewSurgery.ids.push(row.drugid)\r\n        })\r\n\r\n\r\n        this.$http.post(\"/patients/prescribe\",this.drugNewSurgery).then(res =>{\r\n\r\n          this.$message({\r\n            showClose: true,\r\n            message: '恭喜你，操作成功',\r\n            type: 'success'\r\n          });\r\n\r\n          this.dialogTable = false\r\n          this.getTheTypeOfMedicineAndSurgery()\r\n        });\r\n      }\r\n    },\r\n\r\n    //确定进行手术\r\n    affirmSurgery(){\r\n\r\n      if(this.surgerySumMoney==0){\r\n        this.$message({\r\n          showClose: true,\r\n          message: '请选择手术',\r\n          type: 'error'\r\n        });\r\n      }else {\r\n        this.newSurgery.ids = []\r\n        this.multipleSelection.forEach(row => {\r\n          this.newSurgery.ids.push(row.opsid)\r\n        })\r\n        this.$http.post(\"/patients/undergoSurgery\",this.newSurgery).then(res =>{\r\n          this.$message({\r\n            showClose: true,\r\n            message: '恭喜你，操作成功',\r\n            type: 'success'\r\n          });\r\n        });\r\n        this.getTheTypeOfMedicineAndSurgery()\r\n        this.surgery = false\r\n      }\r\n\r\n    },\r\n\r\n\r\n\r\n    //开药\r\n    prescribe(patientsid,doctorid){\r\n      this.getTheTypeOfMedicineAndSurgery()\r\n      this.dialogTable = true\r\n      this.drugNewSurgery.surgeryDoctorid = doctorid\r\n      this.drugNewSurgery.surgeryPatientsid = patientsid\r\n    },\r\n    //手术\r\n    statesurgery(patientsid,doctorid){\r\n      this.getTheTypeOfMedicineAndSurgery()\r\n      this.surgery = true\r\n      this.newSurgery.surgeryPatientsid = patientsid\r\n      this.newSurgery.surgeryDoctorid = doctorid\r\n    },\r\n\r\n    getTheTypeOfMedicineAndSurgery(){\r\n      //获取所有手术类型\r\n      this.$http.get(\"/patients/operationList\",{params:{\r\n          opsname:this.surgeryInput\r\n        }}).then(res =>{\r\n        this.surgeryData = res.data.data\r\n      });\r\n\r\n      //获取药品信息\r\n      this.$http.get(\"/patients/drugList\",{params:{name:this.prescribeInput}}).then(res => {\r\n        this.gridData = res.data.data\r\n      });\r\n\r\n    },\r\n\r\n\r\n    //根据医生Id和选择的时间给出医生的排班时间\r\n    schedulingTime(){\r\n      this.$http.get(\"/patients/scheduling\", {\r\n        params: {\r\n          id: this.form.doctorid,\r\n          clinictime: this.form.clinictime\r\n        }\r\n      }).then(res => {\r\n        this.stimeList = res.data.data;\r\n      })\r\n    },\r\n\r\n    //提交表单\r\n    submitForm(formName){\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          this.$http.post('/patients/' + (this.saveUpdate?'save' : 'update'), this.form)\r\n              .then(res => {\r\n                this.$message({\r\n                  showClose: true,\r\n                  message: '恭喜你，操作成功',\r\n                  type: 'success'\r\n                });\r\n                this.form = {}\r\n                this.getPatientsList()\r\n                this.dialogTableVisible = false\r\n              })\r\n        } else {\r\n\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n\r\n    add(){\r\n      this.timeState = true\r\n      this.saveUpdate = true\r\n      this.dialogTableVisible = true\r\n    },\r\n\r\n    //根据选择的时间给出医生排版时间\r\n    clinictimeDoctor(){\r\n      this.form.doctorid =''\r\n      this.form.atid = ''\r\n\r\n       this.$http.get('/patients/arrange/'+this.form.clinictime).then(res => {\r\n          this.doctorList = res.data.data\r\n       })\r\n    },\r\n    editHandle(id){\r\n      this.timeState = false\r\n      this.saveUpdate = false\r\n      this.$http.get('/patients/info/' + id).then(res => {\r\n        this.form = res.data.data\r\n        this.dialogTableVisible = true\r\n      })\r\n    },\r\n\r\n    handleClose(){\r\n      this.form = {}\r\n      this.dialogTableVisible = false\r\n    },\r\n\r\n    getPatientsList(){\r\n      this.$http.get(\"/patients/list\", {\r\n        params: {\r\n          username: this.input,\r\n          current: this.current,\r\n          size: this.size\r\n        }\r\n      }).then(res => {\r\n        this.tableData = res.data.data.records\r\n        this.size = res.data.data.size\r\n        this.current = res.data.data.current\r\n        this.total = res.data.data.total\r\n      })\r\n    },\r\n\r\n    //操作\r\n    handleEdit(index, row) {\r\n      console.log(index, row);\r\n    },\r\n    mydelete(id,atid) {\r\n\r\n      this.$confirm('此操作将永久删除该患者, 是否继续?', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning',\r\n        center: true\r\n      }).then(() => {\r\n        this.$http.post(\"/patients/delete/\"+id+\":\"+atid).then(res =>{\r\n          this.$message({\r\n            type: 'success',\r\n            message: '删除成功!'\r\n          });\r\n          this.getPatientsList()\r\n        });\r\n      }).catch(() => {\r\n        this.$message({\r\n          type: 'info',\r\n          message: '已取消删除'\r\n        });\r\n      });\r\n    },\r\n\r\n\r\n    //分页\r\n    handleSizeChange(val) {\r\n\r\n      this.size = val\r\n      this.getPatientsList()\r\n    },\r\n    handleCurrentChange(val) {\r\n\r\n      this.current = val\r\n      this.getPatientsList()\r\n    },\r\n\r\n    count_num(data) {\r\n      this.val = data\r\n    }\r\n\r\n  },\r\n\r\n\r\n  name: \"PatientsList\"\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n/*表格样式*/\r\n.demo-table-expand {\r\n  font-size: 0;\r\n}\r\n.demo-table-expand label {\r\n  width: 90px;\r\n  color: #99a9bf;\r\n}\r\n.demo-table-expand .el-form-item {\r\n  margin-right: 0;\r\n  margin-bottom: 0;\r\n  width: 50%;\r\n}\r\n\r\n\r\n</style>\r\n"]}]}